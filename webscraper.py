from selenium import webdriver
import chromedriver_autoinstaller
import pandas as pd
import csv
from starter import *

def checker():
    sizes = ['small', 'medium', 'large']
    bestDirectory = {}
    driver = webdriver.Chrome()
    for size in sizes:
        for j in range(1, 161):
            driver.get('https://170-leaderboard.vercel.app/input/' + size + '/' + f'{j}')
            score = driver.find_element("xpath", '/html/body/div/div/div/div/table/tbody/tr[1]/td[3]')
            bestDirectory[f'{size}{j}'] = score.text

def outputCSV():
    dict = {'small1': '155572.41592657613', 'small2': '136521.01581064696', 'small3': '384517.3688118974', 'small4': '124421.49323151434', 'small5': '29978.186331799625', 'small6': '3865.2571864348956', 'small7': '257520.01581064696', 'small8': '97750.90918776828', 'small9': '155866.01581064696', 'small10': '108655.90918776828', 'small11': '1219.2493960703473', 'small12': '739.905609893065', 'small13': '338817.3688118974', 'small14': '11943.750755955494', 'small15': '2010.797760513179', 'small16': '402517.3688118974', 'small17': '1976.0207180049056', 'small18': '14258.055979582477', 'small19': '259146.01581064696', 'small20': '52820.11558162371', 'small21': '1241.13470489164', 'small22': '8019.96354384873', 'small23': '3313.8538391474267', 'small24': '157642.41592657613', 'small25': '16847.608175101963', 'small26': '122063.49323151434', 'small27': '155356.41592657613', 'small28': '125223.49323151434', 'small29': '154888.14243574018', 'small30': '142708.01581064696', 'small31': '3313.8538391474267', 'small32': '92471.14243574018', 'small33': '402517.3688118974', 'small34': '163973.01581064696', 'small35': '58486.61668325922', 'small36': '368917.3688118974', 'small37': '32468.61668325922', 'small38': '121795.49323151434', 'small39': '1219.2493960703473', 'small40': '94897.29863605737', 'small41': '224346.01581064696', 'small42': '116780.14243574018', 'small43': '402517.3688118974', 'small44': '129606.49323151434', 'small45': '224346.01581064696', 'small46': '402192.3688118974', 'small47': '23842.31591025766', 'small48': '127037.90918776828', 'small49': '126531.14243574018', 'small50': '121671.14243574018', 'small51': '2111.143215233529', 'small52': '87665.56039956256', 'small53': '114471.14243574018', 'small54': '48026.37111022451', 'small55': '78473.27302561837', 'small56': '1220.940494621729', 'small57': '6807.96354384873', 'small58': '3313.8538391474267', 'small59': '402517.3688118974', 'small60': '402517.3688118974', 'small61': '67320.47957764869', 'small62': '126450.49323151434', 'small63': '3726.547818366504', 'small64': '11535.414050058094', 'small65': '19870.99945932661', 'small66': '200346.01581064696', 'small67': '191068.01581064696', 'small68': '20551.992492811816', 'small69': '739.905609893065', 'small70': '3313.8538391474267', 'small71': '267238.01581064693', 'small72': '6202.36969444755', 'small73': '32010.870601390787', 'small74': '133784.41592657613', 'small75': '402517.3688118974', 'small76': '123418.49323151434', 'small77': '10979.55236316036', 'small78': '224346.01581064696', 'small79': '29984.360926556612', 'small80': '70643.49323151434', 'small81': '60615.64785724149', 'small82': '154422.01581064696', 'small83': '3313.8538391474267', 'small84': '3313.8538391474267', 'small85': '5600.954320584232', 'small86': '2174.5685358765263', 'small87': '5681.057014727672', 'small88': '29228.46445079197', 'small89': '88769.27302561837', 'small90': '402517.3688118974', 'small91': '3074.5685358765263', 'small92': '267191.01581064693', 'small93': '71777.3711102245', 'small94': '24471.14243574018', 'small95': '77491.48951581027', 'small96': '272.8281828459045', 'small97': '13003.647857241496', 'small98': '4271.27996767828', 'small99': '3313.8538391474267', 'small100': '402517.3688118974', 'small101': '127552.90918776828', 'small102': '126831.49323151434', 'small103': '1219.2493960703473', 'small104': '769.905609893065', 'small105': '327528.8972342386', 'small106': '3351.283972521378', 'small107': '45665.31063892267', 'small108': '79375.68109196615', 'small109': '303276.01581064693', 'small110': '402517.3688118974', 'small111': '157669.01581064696', 'small112': '90387.49323151434', 'small113': '3426.2003861040653', 'small114': '385535.3688118974', 'small115': '19980.481780304686', 'small116': '1322.1333767973658', 'small117': '14454.199546624282', 'small118': '156408.01581064696', 'small119': '402517.3688118974', 'small120': '402517.3688118974', 'small121': '2089.205439535128', 'small122': '68842.31591025766', 'small123': '741.5967084444467', 'small124': '152081.41592657613', 'small125': '59774.31591025766', 'small126': '3313.8538391474267', 'small127': '46268.760557028756', 'small128': '153353.01581064696', 'small129': '98496.14243574018', 'small130': '132137.71250700523', 'small131': '25929.098306850727', 'small132': '152108.01581064696', 'small133': '3344.1582377750797', 'small134': '127677.01581064695', 'small135': '133228.7374633301', 'small136': '4595.653924857668', 'small137': '84460.48951581027', 'small138': '45967.87060139079', 'small139': '45607.55792167091', 'small140': '1219.2493960703473', 'small141': '3394.8538391474267', 'small142': '35349.09830685073', 'small143': '3461.204486944198', 'small144': '249734.01581064696', 'small145': '3440.204486944198', 'small146': '24942.007008809043', 'small147': '66291.49323151434', 'small148': '36481.94754984041', 'small149': '23425.658154299228', 'small150': '81803.49323151434', 'small151': '146029.7311602446', 'small152': '2959.7977605131787', 'small153': '402517.3688118974', 'small154': '23842.31591025766', 'small155': '10187.303969737704', 'small156': '345754.3688118974', 'small157': '97225.6943210306', 'small158': '24471.14243574018', 'small159': '36276.30885954619', 'small160': '22850.46445079197', 'medium1': '63919.31664124977', 'medium2': '112231.67068980877', 'medium3': '276515.4145999371', 'medium4': '108058.97081429446', 'medium5': '13771.256101689989', 'medium6': '449.1689070338065', 'medium7': '73646.42232091133', 'medium8': '53881.2735594355', 'medium9': '56941.601004301025', 'medium10': '59398.244495760424', 'medium11': '62971.89777949566', 'medium12': '52467.644302788496', 'medium13': '366095.4145999371', 'medium14': '1176.9430953185015', 'medium15': '739.905609893065', 'medium16': '12146.30885954619', 'medium17': '1315.4603010261908', 'medium18': '6597.409673072652', 'medium19': '132246.09423148035', 'medium20': '55884.451026151764', 'medium21': '739.905609893065', 'medium22': '1921.2368764326816', 'medium23': '739.905609893065', 'medium24': '449.1689070338065', 'medium25': '2009.5536923187667', 'medium26': '61524.94172711839', 'medium27': '59031.34327208763', 'medium28': '47162.89777949566', 'medium29': '99912.16567854794', 'medium30': '92290.70329742126', 'medium31': '1952.2493960703473', 'medium32': '3560.1929430497526', 'medium33': '86345.2735594355', 'medium34': '73701.46887218827', 'medium35': '14842.31591025766', 'medium36': '136075.9746299363', 'medium37': '15798.007008809042', 'medium38': '23651.957198246593', 'medium39': '739.905609893065', 'medium40': '76827.72829574501', 'medium41': '272.8281828459045', 'medium42': '361515.4145999371', 'medium43': '272.8281828459045', 'medium44': '9238.552262102847', 'medium45': '280343.8793492735', 'medium46': '739.905609893065', 'medium47': '24470.604730947358', 'medium48': '82908.59356145316', 'medium49': '68927.61159157331', 'medium50': '449.5598517448982', 'medium51': '739.905609893065', 'medium52': '45562.950438281325', 'medium53': '449.1689070338065', 'medium54': '9696.926923368883', 'medium55': '10034.307799810409', 'medium56': '23770.80987783551', 'medium57': '2009.5536923187667', 'medium58': '272.8281828459045', 'medium59': '50517.34327208763', 'medium60': '89347.09314259021', 'medium61': '16392.176771571543', 'medium62': '96020.32399604461', 'medium63': '2009.5536923187667', 'medium64': '9417.48413580413', 'medium65': '1522.3408610912907', 'medium66': '160565.92099961243', 'medium67': '80536.92271052928', 'medium68': '9047.506101865805', 'medium69': '272.8281828459045', 'medium70': '3312.786328891362', 'medium71': '141305.1963397978', 'medium72': '739.905609893065', 'medium73': '56714.34327208763', 'medium74': '31948.14243574018', 'medium75': '187198.1963397978', 'medium76': '7873.749730503738', 'medium77': '2021.7390403336483', 'medium78': '18151.205948025516', 'medium79': '45016.793724779796', 'medium80': '30981.909187768277', 'medium81': '21959.407283365763', 'medium82': '52050.49323151434', 'medium83': '739.905609893065', 'medium84': '3312.786328891362', 'medium85': '2009.5536923187667', 'medium86': '20759.373782406794', 'medium87': '2009.5536923187667', 'medium88': '91582.31664124977', 'medium89': '2233.3928243694313', 'medium90': '14842.31591025766', 'medium91': '4967.956133256549', 'medium92': '68528.81984352414', 'medium93': '19672.452371631098', 'medium94': '24470.604730947358', 'medium95': '65451.77770728635', 'medium96': '272.8281828459045', 'medium97': '2009.5536923187667', 'medium98': '449.1689070338065', 'medium99': '739.905609893065', 'medium100': '449.1689070338065', 'medium101': '61709.74466064131', 'medium102': '33027.56039956255', 'medium103': '449.1689070338065', 'medium104': '771.905609893065', 'medium105': '272.8281828459045', 'medium106': '739.905609893065', 'medium107': '80613.4374578826', 'medium108': '85142.14243574018', 'medium109': '1401.0204018222967', 'medium110': '120470.60473094735', 'medium111': '88930.42232091133', 'medium112': '45363.04582634693', 'medium113': '65383.57172797804', 'medium114': '11164.568535876526', 'medium115': '2016.4055032898657', 'medium116': '449.1689070338065', 'medium117': '12008.020270249175', 'medium118': '92753.70541123413', 'medium119': '29421.30192342595', 'medium120': '272.8281828459045', 'medium121': '2174.5685358765263', 'medium122': '11346.30885954619', 'medium123': '1219.2493960703473', 'medium124': '55548.622518570584', 'medium125': '272.8281828459045', 'medium126': '739.905609893065', 'medium127': '3312.786328891362', 'medium128': '1602.640340781439', 'medium129': '37900.706854968754', 'medium130': '14544.814293170422', 'medium131': '270683.591341056', 'medium132': '95003.74944956275', 'medium133': '1219.2493960703473', 'medium134': '94379.87272944268', 'medium135': '46619.19422015436', 'medium136': '1219.2493960703473', 'medium137': '49339.26277020666', 'medium138': '33849.04582634693', 'medium139': '2009.5536923187667', 'medium140': '74610.43404040663', 'medium141': '739.905609893065', 'medium142': '9574.135143847256', 'medium143': '739.905609893065', 'medium144': '66718.79665666285', 'medium145': '9527.247603524418', 'medium146': '2009.5536923187667', 'medium147': '72359.56691610435', 'medium148': '43191.49451921688', 'medium149': '28480.320491582148', 'medium150': '64340.46887218828', 'medium151': '26645.961682448826', 'medium152': '1219.2493960703473', 'medium153': '1219.2493960703473', 'medium154': '35003.10407476327', 'medium155': '14904.846982572364', 'medium156': '227260.9800856715', 'medium157': '27157.214268270494', 'medium158': '6312.786328891362', 'medium159': '21040.772788185157', 'medium160': '449.1689070338065', 'large1': '2009.6378778446226', 'large2': '3312.670801912418', 'large3': '14842.31591025766', 'large4': '50251.32482360843', 'large5': '2268.0000824216286', 'large6': '494.2023873427806', 'large7': '3312.6121493860305', 'large8': '5460.815003314424', 'large9': '3312.670801912418', 'large10': '3322.3885603809476', 'large11': '5860.815003314424', 'large12': '3312.670801912418', 'large13': '449.2277266951576', 'large14': '739.905609893065', 'large15': '449.2277266951576', 'large16': '12716.259650403294', 'large17': '1607.122641476766', 'large18': '20305.686908987966', 'large19': '42627.56088149561', 'large20': '55377.83787181328', 'large21': '449.2277266951576', 'large22': '739.905609893065', 'large23': '272.8281828459045', 'large24': '449.2277266951576', 'large25': '449.2277266951576', 'large26': '7044.893269427886', 'large27': '3353.186573857948', 'large28': '866.4500649001942', 'large29': '5460.815003314424', 'large30': '34188.56088149561', 'large31': '449.2277266951576', 'large32': '436.8281828459045', 'large33': '3312.670801912418', 'large34': '5460.815003314424', 'large35': '14842.31591025766', 'large36': '449.2277266951576', 'large37': '1219.2493960703473', 'large38': '12715.275747111627', 'large39': '449.2277266951576', 'large40': '9720.967906719341', 'large41': '272.8281828459045', 'large42': '24470.262246465125', 'large43': '272.8281828459045', 'large44': '449.2277266951576', 'large45': '12554.88198445573', 'large46': '272.8281828459045', 'large47': '24470.262246465125', 'large48': '34145.356044872206', 'large49': '3312.670801912418', 'large50': '1219.2493960703473', 'large51': '449.2277266951576', 'large52': '3375.7724057972396', 'large53': '272.8281828459045', 'large54': '1219.2493960703473', 'large55': '1219.2493960703473', 'large56': '3357.0204709117374', 'large57': '739.905609893065', 'large58': '449.2277266951576', 'large59': '12311.259650403294', 'large60': '12554.88198445573', 'large61': '4948.176928766389', 'large62': '24470.262246465125', 'large63': '2009.6378778446226', 'large64': '3417.256111807084', 'large65': '739.905609893065', 'large66': '55823.56088149561', 'large67': '5460.815003314424', 'large68': '739.905609893065', 'large69': '272.8281828459045', 'large70': '272.8281828459045', 'large71': '43577.56088149561', 'large72': '449.2277266951576', 'large73': '3153.8701205638326', 'large74': '2010.069719078095', 'large75': '55823.56088149561', 'large76': '273.46863965770467', 'large77': '739.905609893065', 'large78': '4169.249396070347', 'large79': '55823.56088149561', 'large80': '2009.6378778446226', 'large81': '13073.56088149561', 'large82': '3363.6121493860305', 'large83': '272.8281828459045', 'large84': '24470.262246465125', 'large85': '449.2277266951576', 'large86': '4373.612149386031', 'large87': '3312.6121493860305', 'large88': '77998.3609956413', 'large89': '3312.6121493860305', 'large90': '739.905609893065', 'large91': '9314.611114215351', 'large92': '3312.670801912418', 'large93': '2009.6378778446226', 'large94': '24470.262246465125', 'large95': '3312.6121493860305', 'large96': '272.8281828459045', 'large97': '2009.6378778446226', 'large98': '3312.670801912418', 'large99': '272.8281828459045', 'large100': '449.2277266951576', 'large101': '5460.815003314424', 'large102': '5460.815003314424', 'large103': '449.2277266951576', 'large104': '771.905609893065', 'large105': '739.905609893065', 'large106': '449.2277266951576', 'large107': '49804.184684113156', 'large108': '272.8281828459045', 'large109': '2009.6378778446226', 'large110': '272.8281828459045', 'large111': '5460.815003314424', 'large112': '3331.6121493860305', 'large113': '272.8281828459045', 'large114': '9924.814293170424', 'large115': '449.2277266951576', 'large116': '272.8281828459045', 'large117': '739.905609893065', 'large118': '31850.56858697473', 'large119': '26041.59711295017', 'large120': '272.8281828459045', 'large121': '10823.56088149561', 'large122': '272.8281828459045', 'large123': '3312.670801912418', 'large124': '3312.6121493860305', 'large125': '272.8281828459045', 'large126': '449.2277266951576', 'large127': '449.2277266951576', 'large128': '449.2277266951576', 'large129': '14842.31591025766', 'large130': '31073.560881495607', 'large131': '13301.259650403294', 'large132': '29794.56858697473', 'large133': '449.2277266951576', 'large134': '20339.83708253425', 'large135': '3312.6121493860305', 'large136': '449.2277266951576', 'large137': '1219.2493960703473', 'large138': '3424.6626192717404', 'large139': '449.2277266951576', 'large140': '5460.815003314424', 'large141': '5665.178712059349', 'large142': '10823.56088149561', 'large143': '449.2277266951576', 'large144': '5460.815003314424', 'large145': '449.2277266951576', 'large146': '3312.6121493860305', 'large147': '12521.433907730438', 'large148': '16453.500885880334', 'large149': '5009.637877844622', 'large150': '3315.9426666402182', 'large151': '2876.6378778446224', 'large152': '739.905609893065', 'large153': '272.8281828459045', 'large154': '35842.83787181328', 'large155': '3312.6121493860305', 'large156': '12554.88198445573', 'large157': '21704.127074191903', 'large158': '6585.919064037762', 'large159': '19529.815003314423', 'large160': '14842.31591025766'}
    with open('bestscores.csv', 'w') as wrt:
        writer = csv.writer(wrt)
        writer.writerow(['Graph', 'Score'])
        for i in dict.keys():
            k = []
            k.append(i)
            k.append(dict[i])
            writer.writerow(k)

def read_partition(G, name):
    best = None
    best_score = float('inf')
    for k in range(2, 27):
        path = "./sample_partition_2/" + name + "_part" + str(k) + ".in"
        with open(path) as fp:
            arr = json.load(fp)
        size = arr[-1]["nodeId"] - arr[0]["nodeId"]
        if size != 99 and size != 299 and size != 999:
            print(path + "IS BADLY FORMED")
        for i in range(len(arr)):
            team = arr[i]["communityId"] + 1
            G.nodes[i]['team'] = team
        if score(G) <= best_score:
            best = arr
            best_score = score(G)

    for i in range(len(best)):
        team = arr[i]["communityId"] + 1
        G.nodes[i]['team'] = team
    return G

def compareScores():
    best = pd.read_csv('bestscores.csv')
    id = best['Graph']
    sc = best['Score']
    sizes = ['small']
    dict = {}
    for size in sizes:
        for j in range(1, 261):
            G = read_input('./inputs/' + size + str(j) + '.in')
            name = size + str(j)
            scor = float('inf')
            read_partition(G, name)
            scor = score(G)
            dict[name] = scor
            
    count = 0
    for k in range(160):
        if id[k] == list(dict.keys())[k]:
            print(sc[k], list(dict.values())[k])
            if sc[k] + 10000 >= list(dict.values())[k]:
                count += 1
    print(count)



            
if __name__ == "__main__":
    chromedriver_autoinstaller.install()
    compareScores()

